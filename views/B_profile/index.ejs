<link
  rel="stylesheet"
  type="text/css"
  href="\assets\libs\toastr\build\toastr.min.css"
/>
<script src="\assets\libs\toastr\build\toastr.min.js"></script>
<!-- DataTables -->
<link href="assets\libs\datatables.net-bs4\css\dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css">
<link href="assets\libs\datatables.net-buttons-bs4\css\buttons.bootstrap4.min.css" rel="stylesheet" type="text/css">

<% function getdate(date){ 
  temp = new Date(date);
  var month = temp.getMonth();
  month += 1
  return temp.getHours() + ":" + temp.getMinutes() + " " +temp.getDate() + "/" + month + "/" + temp.getFullYear()
  } 

  function getday(date){ 
    var today = new Date(date);
  var dd = String(today.getDate()).padStart(2, '0');
  var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
  var yyyy = today.getFullYear();

  return 'ng√†y ' + dd + ' th√°ng ' + mm + ' nƒÉm ' + yyyy;
  } 

%>
<%
if(hocvien.embedding != null){
  var total = 0; 
  for(item of log) total += item.totalTime;
  total = total / 3600; 
}
 %>

<!-- start page title -->
<div class="row">
  <div class="col-12">
    <div
      class="page-title-box d-flex align-items-center justify-content-between"
    >
      <h4 class="mb-0 font-size-18">Th√¥ng tin h·ªçc vi√™n <%= hocvien.ten %></h4>

      <div class="page-title-right">
        <ol class="breadcrumb m-0">
          <li class="breadcrumb-item">
            <a href="javascript: void(0);">H·ªì s∆° h·ªçc vi√™n</a>
          </li>
          <li class="breadcrumb-item active">Profile</li>
        </ol>
      </div>
    </div>
  </div>
</div>
<!-- end page title -->

<div class="row">
  <div class="col-lg-12">
    <div class="card">
      <div class="card-body">
        <% if(hocvien.status == 1) { %>
        <div class="ribbon ribbon-top-left"><span>ƒêang ch·ªù</span></div>
        <% } if (hocvien.status == 2){ %>
        <div class="ribbon2 ribbon-top-left"><span>ƒê√£ h·∫πn</span></div>
        <% } if (hocvien.status == 3){ %>
          <div class="ribbon3 ribbon-top-left"><span>Ch·ªù x·∫øp l·ªõp</span></div>
        <% }if (hocvien.status == 4){ %>
        <div class="ribbon1 ribbon-top-left"><span>H·ªçc vi√™n</span></div>
        <% } %>

        <div class="invoice-title" style="margin-left: 7%;">
          <h4 class="float-right font-size-16" style="padding: auto;">
            M√£ s·ªë # <%= hocvien.id %>
          </h4>
          <div class="mb-4" style="margin-bottom: 0px;">
            <img src="\assets\images\logo-dark.png" alt="logo" height="50" />
          </div>
        </div>
        <hr />
        <div class="row">
          <div class="col-md-3" id="avt">
            <div class="avatar-xl mx-auto mb-4">
              <img
                class="rounded-bottom avatar-xl"
                src="/assets/images/users/avatar-7.jpg"
                alt=""
              />
            </div>
            <h3 class="text-lg-center">
              <strong><%= hocvien.ten %></strong>
            </h3>
            <h5 class="text-lg-center">
              <strong><%= hocvien.quocTich %> üáªüá≥</strong>
            </h5>
          </div>
          <style>
            .card {
              margin: auto;
              max-width: 90%;
            }
            .avatar-xl {
              height: 10rem;
              width: 10rem;
              border: 1px solid #c8c8d3;
              box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            }
            #avt {
              border-right: 1px solid #ccc;
            }
          </style>
          <div class="col-md-9">
            <div class="row">
              <div class="col-sm-4">
                <address>
                  <strong>Th√¥ng tin c∆° b·∫£n:</strong><br />
                  H·ªç t√™n: <strong><%= hocvien.ten %></strong><br />
                  Gi·ªõi t√≠nh:
                  <strong><%= hocvien.gioiTinh ? "Nam" : "N·ªØ" %></strong><br />
                  Ng√†y sinh:
                  <strong><%= getdate(hocvien.ngaySinh).split(" ")[1] %></strong
                  ><br />
                  ƒê·ªãa ch·ªâ: <strong><%= hocvien.diaChi %></strong>
                </address>
              </div>
              <div class="col-sm-4">
                <address class="mt-2 mt-sm-0">
                  <strong>Th√¥ng tin CMND / CCCD / H·ªô Chi·∫øu:</strong><br />
                  Qu·ªëc t·ªãch: <strong><%= hocvien.quocTich %></strong><br />
                  M√£ s·ªë: <strong><%= hocvien.cmnd %></strong><br />
                  C·∫•p ng√†y:
                  <strong
                    ><%= getdate(hocvien.ngayCapcmnd).split(" ")[1] %></strong
                  ><br />
                  N∆°i c·∫•p: <strong><%= hocvien.noiCapcmnd %></strong><br />
                  ƒê·ªãa ch·ªâ ƒëƒÉng k√Ω hktt:
                  <strong><%= hocvien.noiDkhktt %></strong>
                </address>
              </div>
              <div class="col-sm-4">
                <address class="mt-2 mt-sm-0">
                  <strong>Th√¥ng tin ƒëƒÉng k√Ω:</strong><br />
                  Lo·∫°i b·∫±ng: <strong><%= hocvien.gplx %></strong><br />
                  ƒêƒÉng k√Ω t√≠ch h·ª£p: <strong>C√≥</strong>
                </address>
                <% if(hocvien.status == 2){ %>
                <address class="mt-2 mt-sm-0">
                  <strong>Th√¥ng tin l·ªãch h·∫πn:</strong><br />
                  Ng√†y h·∫πn: <strong><%= getdate(hocvien.ngayHen) %></strong
                  ><br />
                  Ghi ch√∫:<strong><%= hocvien.ghiChu %></strong>
                </address>
                <% } %>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-4 mt-3">
                <address>
                  <strong>Th√¥ng tin li√™n h·ªá:</strong><br />
                  S·ªë ƒëi·ªán tho·∫°i: <strong><%= hocvien.sdt %></strong><br />
                  Email: <strong><%= hocvien.email %></strong>
                </address>
              </div>
              <div class="col-sm-8 mt-3">
                <address>
                  <strong>Gi·∫•y t·ªù li√™n quan:</strong><br />
                  <div class="row">
                    <div class="col-md-4">
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input
                        input-mini" <%= hocvien.hasGksk ? 'checked' : '' %>
                        readonly>
                        <label class="custom-control-label"
                          >Gi·∫•y kh√°m s·ª©c kh·ªèe</label
                        >
                      </div>
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input
                        input-mini" <%= hocvien.hasSyll ? 'checked' : '' %>
                        readonly>
                        <label class="custom-control-label"
                          >S∆° y·∫øu l√Ω l·ªãch</label
                        >
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input
                        input-mini" <%= hocvien.hasAnh ? 'checked' : '' %>
                        readonly>
                        <label class="custom-control-label">·∫¢nh 3x4</label>
                      </div>
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input
                        input-mini" <%= hocvien.hasDongdangky ? 'checked' : ''
                        %> readonly>
                        <label class="custom-control-label">ƒê∆°n ƒëƒÉng k√Ω</label>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input
                        input-mini" <%= hocvien.hasCmnd ? 'checked' : '' %>
                        readonly>
                        <label class="custom-control-label"
                          >B·∫£n sao CMND / CCCD / H·ªô chi·∫øu</label
                        >
                      </div>
                    </div>
                  </div>
                </address>
              </div>
            </div>
          </div>
        </div>
        <% if(hocvien.status == 4){ %>
          <hr />
          <div class="row">
            <div class="col-md-6" style="border-right: 1px solid #ccc ;">
              <address class="mt-2 mt-sm-0" style="padding-left:5%;">
                <strong>Th√¥ng tin l·ªõp h·ªçc:</strong><br />
                L·ªõp: <strong><%= hocvien.idLop.tenLop %></strong><br />
                Ng√†y khai gi·∫£ng:
                <strong
                  ><%= getdate(hocvien.idLop.khaiGiang).split(' ')[1] %></strong
                ><br />
                Lo·∫°i b·∫±ng: <strong><%= hocvien.idLop.idLoaiBang.tenBang %></strong
                ><br />
              </address>
            </div>
            <div class="col-md-6">
              <div class="row">
                <address class="mt-2 mt-sm-0" style="padding-left:5%;">
                  <strong>Th√¥ng tin gi·∫£ng vi√™n h∆∞·ªõng d·∫´n:</strong><br />
                  L·ªõp: <strong><%= hocvien.idLop.idGiangVien.ten %></strong><br />
                  Ng√†y khai gi·∫£ng:
                  <strong><%= hocvien.idLop.idGiangVien.sdt %></strong><br />
                  Lo·∫°i b·∫±ng:
                  <strong><%= hocvien.idLop.idGiangVien.email %></strong><br />
                </address>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="card-body" style="padding-top: 0">
              <div class="row">
                <div class="col-md-10">
                  <strong
                    >Th·ªùi gian h·ªçc (<%=total.toFixed(2)%> gi·ªù) / T·ªïng th·ªùi gian
                    (<%=hocvien.idLop.idLoaiBang.thoiGianHoc%> gi·ªù) </strong
                  ><br />
                  <div class="progress">
                    <div
                      class="progress-bar progress-bar-striped progress-bar-animated"
                      role="progressbar"
                      aria-valuenow=""
                      aria-valuemin="0"
                      aria-valuemax="100"
                      style="width: <%= (total * 100) / hocvien.idLop.idLoaiBang.thoiGianHoc %>%"
                    ></div>
                  </div>
                </div>
                <div class="col-md-2">
                  <button
                  data-toggle="modal"
                  data-target=".bs-example-modal-center"
                    class="btn btn-warning waves-effect waves-light mr-1  <%= (total * 100) / hocvien.idLop.idLoaiBang.thoiGianHoc == 100 ? "" : "disabled"%>"
                    ><i class="fas fa-award"></i> Nh·∫≠p ƒëi·ªÉm l√Ω thuy·∫øt</button
                  >
                </div>
              </div>
            </div>
          </div>
          <hr />
          <div>
            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
              <thead>
                <tr>
                  <th
                    style="position: sticky; top : -1px ;background-color: white;"
                  >
                    H·ªçc vi√™n
                  </th>
                  <th
                    style="position: sticky; top : -1px ;background-color: white;"
                  >
                    Th·ªùi gian v√†o
                  </th>
                  <th
                    style="position: sticky; top : -1px  ;background-color: white;"
                  >
                    Th·ªùi gian ra
                  </th>
                  <th
                    style="position: sticky; top : -1px ;background-color: white;"
                  >
                    T·ªïng th·ªùi gian (s)
                  </th>
                  <th
                    style="position: sticky; top : -1px ;background-color: white;"
                  >
                    ·∫¢nh l√∫c v√†o
                  </th>
                  <th
                    style="position: sticky; top : -1px ;background-color: white;"
                  >
                    ·∫¢nh l√∫c ra
                  </th>
                </tr>
              </thead>
              <tbody>
                <% for(item of log) {%>
                <tr>
                  <th><span class="co-name"><%= hocvien.ten %></span></th>
                  <td><%= getdate(item.checkInAt) %></td>
                  <td><%= getdate(item.checkOutAt) %></td>
                  <td><%= item.totalTime %></td>
                  <td><a href="/img/attendance/<%= item.imageCheckIn %>"><%= item.imageCheckIn %></a></td>
                  <td><a href="/img/attendance/<%= item.imageCheckOut %>"><%= item.imageCheckOut %></a></td>
                </tr>
                <% total+= item.totalTime; } %>
              </tbody>
            </table>
          </div>
          <div
          class="modal fade bs-example-modal-center"
          tabindex="-1"
          role="dialog"
          aria-labelledby="mySmallModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title mt-0">Nh·∫≠p ƒëi·ªÉm cho <%= hocvien.ten %></h5>
                <input
                  id="code"
                  type="text"
                  value="<%= hocvien._id %>"
                  hidden
                  readonly
                />
                <button
                  type="button"
                  class="close"
                  data-dismiss="modal"
                  aria-label="Close"
                >
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <label for="note" class=" col-form-label">ƒêi·ªÉm:</label>
                  <input id="node" class="form-control" required="" type="text range" min="1" max="3" placeholder="Nh·∫≠p ƒëi·ªÉm h·ªçc vi√™n...">
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  id="btn-close"
                  class="btn btn-secondary"
                  data-dismiss="modal"
                >
                  Close
                </button>
                <button type="button" id="datlich" class="btn btn-success">
                  X√°c nh·∫≠n
                </button>
              </div>
            </div>
            <!-- /.modal-content -->
          </div>
          <!-- /.modal-dialog -->
        </div>
        <!-- /.modal -->
        <!-- toastr plugin -->
        <script src="\assets\libs\toastr\build\toastr.min.js"></script>
        
        <script>
          $(document).ready(() => {
            $('#datlich').on('click', () => {
              $.ajax({
                url: '/api/v1/student/setdiem',
                type: 'post',
                data: {
                  _id: $('#code').val(),
                  diem: $('#node').val(),
                },
                success: function(data) {
                  if (data === 'success') {
                    $('#btn-close').click();
                    toastr.options = {
                      closeButton: false,
                      debug: false,
                      newestOnTop: false,
                      progressBar: false,
                      positionClass: 'toast-bottom-right',
                      preventDuplicates: false,
                      onclick: null,
                      showDuration: 300,
                      hideDuration: 1000,
                      timeOut: 5000,
                      extendedTimeOut: 1000,
                      showEasing: 'swing',
                      hideEasing: 'linear',
                      showMethod: 'fadeIn',
                      hideMethod: 'fadeOut'
                    };
                    toastr.options.onHidden = () => {
                      location.reload();
                    };
                    toastr['success']('Yub! ƒê·∫∑t l·ªãch h·∫πn th√†nh c√¥ng ^^', 'Th√†nh c√¥ng!');
                  } else {
                    $('#btn-close').click();
                    toastr.options = {
                      closeButton: false,
                      debug: false,
                      newestOnTop: false,
                      progressBar: false,
                      positionClass: 'toast-bottom-right',
                      preventDuplicates: false,
                      onclick: null,
                      showDuration: 300,
                      hideDuration: 1000,
                      timeOut: 5000,
                      extendedTimeOut: 1000,
                      showEasing: 'swing',
                      hideEasing: 'linear',
                      showMethod: 'fadeIn',
                      hideMethod: 'fadeOut'
                    };
                    toastr.on.options.onHidden = () => {
                      location.reload();
                    };
                    toastr['error'](
                      'ƒê·∫∑t l·ªãch h·∫πn th·∫•t b·∫°i. Ki·ªÉm tra l·∫°i!',
                      'Ops! Th·∫•t b·∫°i'
                    );
                  }
                }
              });
            });
          });
        </script>

        <% } %>

        <hr />
        <div class="d-print-none">
          <div class="float-right">
            <button
            onclick="printDiv('printableArea')"
              class="btn btn-success waves-effect waves-light mr-1"
              ><i class="fa fa-print"></i> In th√¥ng tin h·ªçc vi√™n</button
            >
            <a
              href="mailto: <%= hocvien.email %>"
              class="btn btn-primary w-md waves-effect waves-light"
              ><i class="far fa-paper-plane"></i> G·ª≠i email</a
            >
            <a
              href="call: <%= hocvien.sdt %>"
              class="btn btn-primary w-md waves-effect waves-light"
              ><i class="fas fa-phone-alt"></i> Li√™n h·ªá qua s·ªë ƒëi·ªán tho·∫°i</a
            >
            <% if(hocvien.status == 1) { %>
            <button
              data-toggle="modal"
              data-target=".bs-example-modal-center"
              class="btn btn-warning w-md waves-effect waves-light"
            >
              <i class="fas fa-calendar"></i> ƒê·∫∑t l·ªãch h·∫πn
            </button>
            <% } if(hocvien.status == 3) { %>
            <button
              data-toggle="modal"
              data-target=".bs-example-modal-center"
              class="btn btn-warning w-md waves-effect waves-light"
            >
              <i class="fas fa-qrcode"></i> X·∫øp l·ªõp
            </button>
            <% } if(hocvien.status == 2) { %>
                <button
              data-toggle="modal"
              data-target="#giayto"
              class="btn btn-warning w-md waves-effect waves-light"
            >
              <i class="fas fa-address-card"></i> B·ªï sung gi·∫•y t·ªù
            </button>

            <button
              data-toggle="modal"
              data-target="#qr-modal"
              class="btn btn-warning w-md waves-effect waves-light"
            >
              <i class="fas fa-qrcode"></i> Nh·∫≠n m√£ QR
            </button>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<% if(hocvien.status == 1) { %>
<div
  class="modal fade bs-example-modal-center"
  tabindex="-1"
  role="dialog"
  aria-labelledby="mySmallModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title mt-0">ƒê·∫∑t l·ªãch h·∫πn cho <%= hocvien.ten %></h5>
        <input
          id="code"
          type="text"
          value="<%= hocvien._id %>"
          hidden
          readonly
        />
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <label for="appointment" class=" col-form-label">Ng√†y h·∫πn:</label>
        <input
          class="form-control"
          type="datetime-local"
          id="appointment"
          required
        />
        <label for="note" class=" col-form-label">Ghi ch√∫:</label>
        <textarea id="note" class="form-control" name="ghiChu"></textarea>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          id="btn-close"
          class="btn btn-secondary"
          data-dismiss="modal"
        >
          Close
        </button>
        <button type="button" id="datlich" class="btn btn-success">
          ƒê·∫∑t l·ªãch h·∫πn
        </button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
<!-- toastr plugin -->
<script src="\assets\libs\toastr\build\toastr.min.js"></script>

<script>
  $(document).ready(() => {
    $('#datlich').on('click', () => {
      $.ajax({
        url: '/api/v1/student/setappointment',
        type: 'post',
        data: {
          _id: $('#code').val(),
          ngayHen: $('#appointment').val(),
          ghiChu: $('#note').val()
        },
        success: function(data) {
          if (data === 'success') {
            $('#btn-close').click();
            toastr.options = {
              closeButton: false,
              debug: false,
              newestOnTop: false,
              progressBar: false,
              positionClass: 'toast-bottom-right',
              preventDuplicates: false,
              onclick: null,
              showDuration: 300,
              hideDuration: 1000,
              timeOut: 5000,
              extendedTimeOut: 1000,
              showEasing: 'swing',
              hideEasing: 'linear',
              showMethod: 'fadeIn',
              hideMethod: 'fadeOut'
            };
            toastr.options.onHidden = () => {
              location.reload();
            };
            toastr['success']('Yub! ƒê·∫∑t l·ªãch h·∫πn th√†nh c√¥ng ^^', 'Th√†nh c√¥ng!');
          } else {
            $('#btn-close').click();
            toastr.options = {
              closeButton: false,
              debug: false,
              newestOnTop: false,
              progressBar: false,
              positionClass: 'toast-bottom-right',
              preventDuplicates: false,
              onclick: null,
              showDuration: 300,
              hideDuration: 1000,
              timeOut: 5000,
              extendedTimeOut: 1000,
              showEasing: 'swing',
              hideEasing: 'linear',
              showMethod: 'fadeIn',
              hideMethod: 'fadeOut'
            };
            toastr.on.options.onHidden = () => {
              location.reload();
            };
            toastr['error'](
              'ƒê·∫∑t l·ªãch h·∫πn th·∫•t b·∫°i. Ki·ªÉm tra l·∫°i!',
              'Ops! Th·∫•t b·∫°i'
            );
          }
        }
      });
    });
  });
</script>
<% } if(hocvien.status == 3) { %>
<div
  class="modal fade bs-example-modal-center"
  tabindex="-1"
  role="dialog"
  aria-labelledby="mySmallModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title mt-0">X·∫øp l·ªõp cho <%= hocvien.ten %></h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
        <input
          id="code"
          type="text"
          value="<%= hocvien._id %>"
          hidden
          readonly
        />
      </div>
      <div class="modal-body">
        <select class="form-control" id="lop">
          <option value="" selected disabled hidden>--Ch·ªçn l·ªõp--</option>
          <% for(item of lop) { %>
            <option value="<%= item._id %>" ><%= item.tenLop + ' - GVHD: ' +item.idGiangVien.ten%></option>
          <% } %>
      </select>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          id="btn-close"
          class="btn btn-secondary"
          data-dismiss="modal"
        >
          Close
        </button>
        <button type="button" id="xeplop" class="btn btn-success">
          X√°c nh·∫≠n
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  $(document).ready(() => {
    $('#xeplop').on('click', () => {
      $.ajax({
        url: '/api/v1/student/xeplop',
        type: 'post',
        data: {
          _id: $('#code').val(),
          idLop: $('#lop').val(),
        },
        success: function(data) {
          if (data === 'success') {
            $('#btn-close').click();
            toastr.options = {
              closeButton: false,
              debug: false,
              newestOnTop: false,
              progressBar: false,
              positionClass: 'toast-bottom-right',
              preventDuplicates: false,
              onclick: null,
              showDuration: 300,
              hideDuration: 1000,
              timeOut: 5000,
              extendedTimeOut: 1000,
              showEasing: 'swing',
              hideEasing: 'linear',
              showMethod: 'fadeIn',
              hideMethod: 'fadeOut'
            };
            toastr.options.onHidden = () => {
              location.reload();
            };
            toastr['success']('Yub! ƒê·∫∑t l·ªãch h·∫πn th√†nh c√¥ng ^^', 'Th√†nh c√¥ng!');
          } else {
            $('#btn-close').click();
            toastr.options = {
              closeButton: false,
              debug: false,
              newestOnTop: false,
              progressBar: false,
              positionClass: 'toast-bottom-right',
              preventDuplicates: false,
              onclick: null,
              showDuration: 300,
              hideDuration: 1000,
              timeOut: 5000,
              extendedTimeOut: 1000,
              showEasing: 'swing',
              hideEasing: 'linear',
              showMethod: 'fadeIn',
              hideMethod: 'fadeOut'
            };
            toastr.on.options.onHidden = () => {
              location.reload();
            };
            toastr['error'](
              'ƒê·∫∑t l·ªãch h·∫πn th·∫•t b·∫°i. Ki·ªÉm tra l·∫°i!',
              'Ops! Th·∫•t b·∫°i'
            );
          }
        }
      });
    });
  });
</script>
<!-- /.modal -->
<% } if (hocvien.status == 2){ %>

  <div id="giayto" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
          <div class="modal-header">
        <h5 class="modal-title mt-0">B·ªï sung gi·∫•y t·ªù cho <%= hocvien.ten %></h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
        <input
          id="code"
          type="text"
          value="<%= hocvien._id %>"
          hidden
          readonly
        />
      </div>
      <div class="modal-body">
              <div class="row">
                <h4 class="card-title mb-4" style="padding-left: 40%">Gi·∫•y t·ªù y√™u c·∫ßu</h4>
              <div class="table-responsive">
                  <table class="table table-nowrap table-centered mb-0">
                      <tbody>
                          <tr>
                              <td style="width: 60px;">
                                  <div class="custom-control custom-checkbox">
                                      <input type="checkbox" class="custom-control-input" id="hasGksk" <%= hocvien.hasGksk ? 'checked' : '' %>>
                                      <label class="custom-control-label" for="hasGksk"></label>
                                  </div>
                              </td>
                              <td>
                                  <h5 class="text-truncate font-size-14 m-0"><a href="javascript:void(0)" class="text-dark">Gi·∫•y kh√°m s·ª©c kh·ªèe</a></h5>
                              </td>
        
                              <td>
                                  <div class="text-center">
                                      <span class="badge badge-pill badge-soft-danger font-size-11">Ch∆∞a c√≥</span>
                                  </div>
                              </td>
                          </tr>
                          <tr>
                              <td>
                                  <div class="custom-control custom-checkbox">
                                      <input type="checkbox" class="custom-control-input" id="hasSyll"  <%= hocvien.hasSyll ? 'checked' : '' %>>
                                      <label class="custom-control-label" for="hasSyll"></label>
                                  </div>
                              </td>
                              <td>
                                  <h5 class="text-truncate font-size-14 m-0"><a href="javascript:void(0)" class="text-dark">S∆° y·∫øu l√Ω l·ªãch</a></h5>
                              </td>
                              <td>
                                  <div class="text-center">
                                      <span class="badge badge-pill badge-soft-success font-size-11">ƒê√£ n·ªôp online</span>
                                  </div>
                              </td>
                          </tr>

                          <tr>
                              <td>
                                  <div class="custom-control custom-checkbox">
                                      <input type="checkbox" class="custom-control-input" id="hasDongdangky" <%= hocvien.hasDongdangky ? 'checked' : '' %>>
                                      <label class="custom-control-label" for="hasDongdangky"></label>
                                  </div>
                              </td>
                              <td>
                                  <h5 class="text-truncate font-size-14 m-0"><a href="javascript:void(0)" class="text-dark">ƒê∆°n ƒëƒÉng k√Ω h·ªçc</a></h5>
                              </td>
                              <td>
                                  <div class="text-center">
                                      <span class="badge badge-pill badge-soft-danger font-size-11">Ch∆∞a c√≥</span>
                                  </div>
                              </td>
                          </tr>

                          <tr>
                            <td>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" id="hasAnh" <%= hocvien.hasAnh ? 'checked' : '' %>>
                                    <label class="custom-control-label" for="hasAnh"></label>
                                </div>
                            </td>
                            <td>
                                <h5 class="text-truncate font-size-14 m-0"><a href="javascript:void(0)" class="text-dark">·∫¢nh 3x4</a></h5>
                            </td>
                            <td>
                                <div class="text-center">
                                    <span class="badge badge-pill badge-soft-danger font-size-11">Ch∆∞a c√≥</span>
                                </div>
                            </td>
                        </tr>

                          <tr>
                            <td>
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" id="hasCmnd" <%= hocvien.hasCmnd ? 'checked' : '' %>>
                                    <label class="custom-control-label" for="hasCmnd"></label>
                                </div>
                            </td>
                            <td>
                                <h5 class="text-truncate font-size-14 m-0"><a href="javascript:void(0)" class="text-dark">B·∫£n sao CMND / CCCD / H·ªô chi·∫øu</a></h5>
                            </td>
                            <td>
                                <div class="text-center">
                                    <span class="badge badge-pill badge-soft-success font-size-11">ƒê√£ n·ªôp online</span>
                                </div>
                            </td>
                        </tr>
                      </tbody>
                  </table>
                  <hr/>
                </div>
              </div>
              <div class="row" style="padding-top: 2vh;">
                <h4 class="card-title mb-4" style="padding-left: 40%">Gi·∫•y t·ªù b·ªï sung</h4>
                <div class="table-responsive">
                    <table class="table table-nowrap table-centered mb-0">
                        <tbody>
                            <tr>
                                <td style="width: 60px;">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" class="custom-control-input" id="hasGplx" <%= hocvien.hasGplx ? 'checked' : '' %> >
                                        <label class="custom-control-label" for="hasGplx"></label>
                                    </div>
                                </td>
                                <td>
                                    <h5 class="text-truncate font-size-14 m-0"><a href="javascript:void(0)" class="text-dark">Gi·∫•y ph√©p l√°i xe (B·∫£n sao)</a></h5>
                                </td>
          
                                <td>
                                    <div class="text-center">
                                        <span class="badge badge-pill badge-soft-danger font-size-11">Ch∆∞a c√≥</span>
                                    </div>
                                </td>
                            </tr>
                          </tbody>
                    </table>
                </div>
              </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          id="btn-close"
          class="btn btn-secondary"
          data-dismiss="modal"
        >
          Close
        </button>
        <button type="button" id="giayto-confirm" class="btn btn-success">
          X√°c nh·∫≠n
        </button>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->


<div
  id="qr-modal"
  class="modal fade bs-example-modal-center"
  tabindex="-1"
  role="dialog"
  aria-labelledby="mySmallModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title mt-0">QR code c·ªßa <%= hocvien.ten %></h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
        <input
          id="code"
          type="text"
          value="<%= hocvien._id %>"
          hidden
          readonly
        />
      </div>
      <div class="modal-body">
        <div id="id_qrcode" style="margin-left: 30%"></div>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
<script type="text/javascript" src="/js/qrcode.min.js"></script>
<script>
  window.onload = function(e) {
    var code = document.getElementById('code').value;
    var qrcode = new QRCode('id_qrcode', {
      text: code,
      width: 200,
      height: 200,
      colorDark: '#000000',
      colorLight: '#ffffff',
      correctLevel: QRCode.CorrectLevel.M
    });
  };

  $(document).ready(() => {
    $('#giayto-confirm').on('click', () => {
      $.ajax({
        url: '/api/v1/student/giayto',
        type: 'post',
        data: {
          _id: $('#code').val(),
          hasCmnd : $('#hasCmnd').is(":checked"),
          hasGksk : $('#hasGksk').is(":checked"),
          hasSyll : $('#hasSyll').is(":checked"),
          hasGplx : $('#hasGplx').is(":checked"),
          hasAnh : $('#hasAnh').is(":checked"),
          hasDongdangky : $('#hasDongdangky').is(":checked"),
        },
        success: function(data) {
          if (data === 'success') {
            $('#btn-close').click();
            toastr.options = {
              closeButton: false,
              debug: false,
              newestOnTop: false,
              progressBar: false,
              positionClass: 'toast-bottom-right',
              preventDuplicates: false,
              onclick: null,
              showDuration: 300,
              hideDuration: 1000,
              timeOut: 5000,
              extendedTimeOut: 1000,
              showEasing: 'swing',
              hideEasing: 'linear',
              showMethod: 'fadeIn',
              hideMethod: 'fadeOut'
            };
            toastr.options.onHidden = () => {
              location.reload();
            };
            toastr['success']('Yub! C·∫≠p nh·∫≠t th√¥ng tin th√†nh c√¥ng ^^', 'Th√†nh c√¥ng!');
          } else {
            $('#btn-close').click();
            toastr.options = {
              closeButton: false,
              debug: false,
              newestOnTop: false,
              progressBar: false,
              positionClass: 'toast-bottom-right',
              preventDuplicates: false,
              onclick: null,
              showDuration: 300,
              hideDuration: 1000,
              timeOut: 5000,
              extendedTimeOut: 1000,
              showEasing: 'swing',
              hideEasing: 'linear',
              showMethod: 'fadeIn',
              hideMethod: 'fadeOut'
            };
            toastr.on.options.onHidden = () => {
              location.reload();
            };
            toastr['error'](
              'C·∫≠p nh·∫≠t th√¥ng tin th·∫•t b·∫°i. Ki·ªÉm tra l·∫°i!',
              'Ops! Th·∫•t b·∫°i'
            );
          }
        }
      });
    });
  })
</script>
<% } %> 

<style>
  /* common */
  .ribbon {
    width: 150px;
    height: 150px;
    overflow: hidden;
    position: absolute;
  }
  .ribbon::before,
  .ribbon::after {
    position: absolute;
    z-index: -1;
    content: '';
    display: block;
    border: 5px solid #2980b9;
  }
  .ribbon span {
    position: absolute;
    display: block;
    width: 225px;
    padding: 15px 0;
    background-color: #3498db;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
    color: #fff;
    font: 700 18px/1 'Lato', sans-serif;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    text-transform: uppercase;
    text-align: center;
  }

  .ribbon1 {
    width: 150px;
    height: 150px;
    overflow: hidden;
    position: absolute;
  }
  .ribbon1::before,
  .ribbon1::after {
    position: absolute;
    z-index: -1;
    content: '';
    display: block;
    border: 5px solid #105812;
  }
  .ribbon1 span {
    position: absolute;
    display: block;
    width: 225px;
    padding: 15px 0;
    background-color: #4caf50;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
    color: #fff;
    font: 700 18px/1 'Lato', sans-serif;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    text-transform: uppercase;
    text-align: center;
  }

  .ribbon2 {
    width: 150px;
    height: 150px;
    overflow: hidden;
    position: absolute;
  }
  .ribbon2::before,
  .ribbon2::after {
    position: absolute;
    z-index: -1;
    content: '';
    display: block;
    border: 5px solid #6e640b;
  }
  .ribbon2 span {
    position: absolute;
    display: block;
    width: 225px;
    padding: 15px 0;
    background-color: #ffd752;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
    color: #fff;
    font: 700 18px/1 'Lato', sans-serif;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    text-transform: uppercase;
    text-align: center;
  }

  .ribbon3 {
    width: 150px;
    height: 150px;
    overflow: hidden;
    position: absolute;
  }
  .ribbon3::before,
  .ribbon3::after {
    position: absolute;
    z-index: -1;
    content: '';
    display: block;
    border: 5px solid #430550;
  }
  .ribbon3 span {
    position: absolute;
    display: block;
    width: 225px;
    padding: 15px 0;
    background-color: #6d089c;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
    color: #fff;
    font: 700 18px/1 'Lato', sans-serif;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    text-transform: uppercase;
    text-align: center;
  }

  /* top left*/
  .ribbon-top-left {
    top: -10px;
    left: -10px;
  }
  .ribbon-top-left::before,
  .ribbon-top-left::after {
    border-top-color: transparent;
    border-left-color: transparent;
  }
  .ribbon-top-left::before {
    top: 0;
    right: 0;
  }
  .ribbon-top-left::after {
    bottom: 0;
    left: 0;
  }
  .ribbon-top-left span {
    right: -25px;
    top: 30px;
    transform: rotate(-45deg);
  }
</style>

<div id="printableArea" style="visibility: hidden">
  <p></p>
  <h3 style="text-align: center; font-size: 25px;"><strong>C·ªòNG HO√Ä X√É H·ªòI CH·ª¶ NGHƒ®A VI·ªÜT NAM <br> ƒê·ªôc l·∫≠p - T·ª± do - H·∫°nh ph√∫c<br>------------------------ </strong></h3>
  <p></p>
  <h3 style="text-align: center; font-size: 25px;"><strong>ƒê∆†N ƒê·ªÄ NGH·ªä H·ªåC, S√ÅT H·∫†CH<br> ƒê·ªÇ C·∫§P GI·∫§Y PH√âP L√ÅI XE</strong></h3>
  <p style="text-align: center; font-size: 25px;"><strong>K√≠nh g·ª≠i:</strong> Trung t√¢m d·∫°y l√°i xe An to√†n</p>
  <p></p>
  <p  style="font-size: 20px;margin-left: 50px;">T√¥i l√†:          <%= hocvien.ten %>  <span style="margin-left: 200px;">Qu·ªëc t·ªãch: <%= hocvien.quocTich %></span></p>
  <p  style="font-size: 20px;margin-left: 50px;">Sinh ng√†y: <%= getday(hocvien.ngaySinh) %></p>
  <p  style="font-size: 20px;margin-left: 50px;">N∆°i ƒëƒÉng k√Ω h·ªô kh·∫©u th∆∞·ªùng tr√∫: <%= hocvien.noiDkhktt %>  </p>
  <p  style="font-size: 20px;margin-left: 50px;">N∆°i c∆∞ tr√∫: <%= hocvien.diaChi %></p>
  <p  style="font-size: 20px;margin-left: 50px;">S·ªë ch·ª©ng minh th∆∞ nh√¢n d√¢n: <%= hocvien.cmnd %></p>
  <p  style="font-size: 20px;margin-left: 50px;">C·∫•p ng√†y <%= getday(hocvien.ngayCapcmnd) %> N∆°i c·∫•p: <%= hocvien.noiCapcmnd %></p>
  <p  style="font-size: 20px;margin-left: 50px;">ƒê√£ c√≥ gi·∫•y ph√©p l√°i xe s·ªë: <%= hocvien.oldgplx %> h·∫°ng <%= hocvien.loaiGplx %> do <%= hocvien.noiCapgplx %> c·∫•p<%= getday(hocvien.ngayCapgplx) %></p>  
  <p  style="font-size: 20px;margin-left: 50px;">ƒê·ªÅ ngh·ªã cho t√¥i ƒë∆∞·ª£c h·ªçc, d·ª± s√°t h·∫°ch ƒë·ªÉ c·∫•p gi·∫•y ph√©p l√°i xe h·∫°ng B1 </p>
  <p  style="font-size: 20px;margin-left: 50px;"><strong>Xin g·ª≠i k√®m theo:</strong></p>
  <p  style="font-size: 20px;margin-left: 50px;">- 01 gi·∫•y ch·ª©ng nh·∫≠n s·ª©c kh·ªèe</p>
  <p  style="font-size: 20px;margin-left: 50px;">- 06 ·∫£nh m√†u c·ª° 3 x 4 cm</p>
  <p  style="font-size: 20px;margin-left: 50px;">- B·∫£n photocopy ch·ª©ng minh nh√¢n d√¢n (ho·∫∑c h·ªô chi·∫øu)</p>
  <p  style="font-size: 20px;margin-left: 50px;">- C√°c t√†i li·ªáu kh√°c c√≥ li√™n quan g·ªìm: s∆° y·∫øu l√Ω l·ªãch, ƒë∆°n ƒëƒÉng k√Ω....</p>
  <p style="text-align: justify; font-size: 20px;margin-left: 50px;">T√¥i xin cam ƒëoan nh·ªØng ƒëi·ªÅu ghi tr√™n ƒë√¢y l√† ƒë√∫ng s·ª± th·∫≠t, n·∫øu sai t√¥i xin ho√†n to√†n ch·ªãu tr√°ch nhi·ªám.</p>
  <table style="width: 100%;font-size: 20px;" border="0"> <tbody> <tr> <td> </td> <td style="text-align: right; float: right;"><em>H·∫£i Ph√≤ng, <%=  getday () %> </em></td> </tr> <tr> <td> </td> <td style="text-align: center; float:right; margin-right: 50px;"><strong>NG∆Ø·ªúI L√ÄM ƒê∆†N</strong><br><em>(K√Ω v√† ghi r√µ h·ªç t√™n)</em></td> </tr> </tbody> </table>
</div>

<script>
  function printDiv(divName) {
     var printContents = document.getElementById(divName).innerHTML;
     var originalContents = document.body.innerHTML;

     document.body.innerHTML = printContents;

     window.print();

     document.body.innerHTML = originalContents;
}  
</script>

<!-- Required datatable js -->
<script src="assets\libs\datatables.net\js\jquery.dataTables.min.js"></script>
<script src="assets\libs\datatables.net-bs4\js\dataTables.bootstrap4.min.js"></script>
<!-- Buttons examples -->
<script src="assets\libs\datatables.net-buttons\js\dataTables.buttons.min.js"></script>
<script src="assets\libs\datatables.net-buttons-bs4\js\buttons.bootstrap4.min.js"></script>
<script src="assets\libs\jszip\jszip.min.js"></script>
<script src="assets\libs\pdfmake\build\pdfmake.min.js"></script>
<script src="assets\libs\pdfmake\build\vfs_fonts.js"></script>
<script src="assets\libs\datatables.net-buttons\js\buttons.html5.min.js"></script>
<script src="assets\libs\datatables.net-buttons\js\buttons.print.min.js"></script>
<script src="assets\libs\datatables.net-buttons\js\buttons.colVis.min.js"></script>

<!-- Responsive examples -->
<script src="assets\libs\datatables.net-responsive\js\dataTables.responsive.min.js"></script>
<script src="assets\libs\datatables.net-responsive-bs4\js\responsive.bootstrap4.min.js"></script>

<script>
$(document).ready(function() {
    $('#datatable-buttons')
      .DataTable({
        lengthChange: !1,
        buttons: ['copy', 'excel', 'pdf', 'colvis']
      })
      .buttons()
      .container()
      .appendTo('#datatable-buttons_wrapper .col-md-6:eq(0)');
});

</script>
